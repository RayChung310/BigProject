<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>退貨統計圖表</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <meta charset="UTF-8">
</head>
<body>
<h2>退貨統計</h2>

<canvas id="monthlyChart" width="600" height="300"></canvas>
<canvas id="topProductChart" width="600" height="300"></canvas>

<script th:inline="javascript">
    // 月統計資料
    let rawMonthly = /*[[${monthlyStats}]]*/ [];
    let rawTop = /*[[${topProducts}]]*/ [];

    let labels = Array.isArray(rawMonthly) ? rawMonthly.map(row => row[0]) : [];
    let data = Array.isArray(rawMonthly) ? rawMonthly.map(row => row[1]) : [];

    let topLabels = Array.isArray(rawTop) ? rawTop.map(row => row[0]) : [];
    let topCounts = Array.isArray(rawTop) ? rawTop.map(row => row[1]) : [];
    
    
    new Chart(document.getElementById('monthlyChart'), {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: '每月退貨金額',
                data: data,
                backgroundColor: 'rgba(75, 192, 192, 0.6)',
                borderWidth: 1
            }]
        }
    });

    // 退貨商品排行榜

    new Chart(document.getElementById('topProductChart'), {
        type: 'pie',
        data: {
            labels: topLabels,
            datasets: [{
                label: '退貨商品排行',
                data: topCounts,
                backgroundColor: [
                    '#FF6384', '#36A2EB', '#FFCE56', '#9CCC65', '#FF7043'
                ]
            }]
        }
    });
</script>



</body>
</html>
